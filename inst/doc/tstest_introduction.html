<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Time Series Tests</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<style type="text/css">detaiks.chunk-details > summary.chunk-summary {
text-align: right;
}
details.chunk-details[open] > summary.chunk-summary::after {
content: "Hide";
}
details.chunk-details[open] > summary.chunk-summary > span.chunk-summary-text {
display: none;
}
</style>
<style type="text/css">.tabwid {
font-size: initial;
padding-bottom: 1em;
}
.tabwid table{
border-spacing:0px !important;
border-collapse:collapse;
line-height:1;
margin-left:auto;
margin-right:auto;
border-width: 0;
border-color: transparent;
caption-side: top;
}
.tabwid-caption-bottom table{
caption-side: bottom;
}
.tabwid_left table{
margin-left:0;
}
.tabwid_right table{
margin-right:0;
}
.tabwid td, .tabwid th {
padding: 0;
}
.tabwid a {
text-decoration: none;
}
.tabwid thead {
background-color: transparent;
}
.tabwid tfoot {
background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
margin: 0 0 !important;
}
</style>
<script>document.addEventListener("DOMContentLoaded", function(event) {
  var els = document.querySelectorAll(".tabwid");
  var tabwid_link = document.querySelector('link[href*="tabwid.css"]')
  if (tabwid_link === null) {
    const tabwid_styles = document.evaluate("//style[contains(., 'tabwid')]", document, null, XPathResult.ANY_TYPE, null );
    tabwid_link = tabwid_styles.iterateNext();
  }

  Array.prototype.forEach.call(els, function(template) {
      const dest = document.createElement("div");
      template.parentNode.insertBefore(dest, template.nextSibling)
      dest.setAttribute("class", "flextable-shadow-host");
      const fantome = dest.attachShadow({mode: 'open'});
      fantome.appendChild(template);
      if (tabwid_link !== null) {
        fantome.appendChild(tabwid_link.cloneNode(true));
      }
  });
});

</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
text-align: justify;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
color: #008B00;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
color: #008B00;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
color: #008B00;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
color: #008B00;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #008B00;
text-decoration: none;
}
a:hover {
color: #006600; }
a:visited {
color: #006600; }
a:visited:hover {
color: #004400; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Time Series Tests</h1>


<div id="TOC">
<ul>
<li><a href="#sec-introduction" id="toc-sec-introduction">Introduction</a></li>
<li><a href="#goodness-of-fit-tests" id="toc-goodness-of-fit-tests">Goodness of Fit Tests</a>
<ul>
<li><a href="#gmm-orthogonality" id="toc-gmm-orthogonality">GMM
Orthogonality</a></li>
<li><a href="#non-parametric-density-test" id="toc-non-parametric-density-test">Non Parametric Density
Test</a></li>
<li><a href="#parameter-constancy" id="toc-parameter-constancy">Parameter Constancy</a></li>
<li><a href="#sign-bias" id="toc-sign-bias">Sign Bias</a></li>
</ul></li>
<li><a href="#forecast-evaluation-tests" id="toc-forecast-evaluation-tests">Forecast Evaluation Tests</a>
<ul>
<li><a href="#density-forecast" id="toc-density-forecast">Density
Forecast</a></li>
<li><a href="#directional-accuracy" id="toc-directional-accuracy">Directional Accuracy</a></li>
<li><a href="#forecast-unbiasedness" id="toc-forecast-unbiasedness">Forecast Unbiasedness</a></li>
<li><a href="#expected-shortfall" id="toc-expected-shortfall">Expected
Shortfall</a></li>
<li><a href="#the-unconditional-test" id="toc-the-unconditional-test">The Unconditional Test</a></li>
<li><a href="#the-conditional-test" id="toc-the-conditional-test">The
Conditional Test</a></li>
<li><a href="#example" id="toc-example">Example</a></li>
<li><a href="#value-at-risk-coverage-and-duration" id="toc-value-at-risk-coverage-and-duration">Value at Risk: Coverage and
Duration</a></li>
<li><a href="#proportion-of-failures-uc" id="toc-proportion-of-failures-uc">Proportion of Failures
(<code>UC</code>)</a></li>
<li><a href="#independence-of-failures-cci" id="toc-independence-of-failures-cci">Independence of Failures
(<code>CCI</code>)</a></li>
<li><a href="#conditional-coverage-cc" id="toc-conditional-coverage-cc">Conditional Coverage
(<code>CC</code>)</a></li>
<li><a href="#duration-between-failures-d" id="toc-duration-between-failures-d">Duration between Failures
(<code>D</code>)</a></li>
<li><a href="#example-1" id="toc-example-1">Example</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tstests)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tsdistributions)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tsgarch)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;spy&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;arma_forecast&quot;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;garch_forecast&quot;</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>spyr <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">diff</span>(<span class="fu">log</span>(spy)))</span></code></pre></div>
</details>
<div id="sec-introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>tstests</code> package provides a number of different
statistical tests for evaluating the goodness of fit of time series
models as well as their out of sample predictions.</p>
<p>The table below summarizes the tests currently implemented, together
with the reference paper and type of test. The tests are broadly
categorized as Wald [W], Likelihood Ratio [LR], Hausman [H], Lagrange
Multiplier [LM] and Portmanteau [P].</p>
<div style="font-size: 15px">
<table style="width:100%;">
<caption>Package Tests</caption>
<colgroup>
<col width="34%" />
<col width="16%" />
<col width="39%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Test</th>
<th align="left">Function</th>
<th align="left">Reference</th>
<th align="right">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GMM Orthogonality Test</td>
<td align="left">gmm_test</td>
<td align="left"><span class="citation">(L. P. Hansen 1982)</span></td>
<td align="right">[W]</td>
</tr>
<tr class="even">
<td align="left">Nyblom Parameter Constancy Test</td>
<td align="left">nyblom_test</td>
<td align="left"><span class="citation">(Nyblom 1989)</span></td>
<td align="right">[LM]</td>
</tr>
<tr class="odd">
<td align="left">Sign Bias Test</td>
<td align="left">signbias_test</td>
<td align="left"><span class="citation">(Engle and Ng 1993)</span></td>
<td align="right">[W]</td>
</tr>
<tr class="even">
<td align="left">Berkowitz Forecast Density Test</td>
<td align="left">berkowitz_test</td>
<td align="left"><span class="citation">(Berkowitz 2001)</span></td>
<td align="right">[LR]</td>
</tr>
<tr class="odd">
<td align="left">Hong-Li Non Parametric Density Test.</td>
<td align="left">hongli_test</td>
<td align="left"><span class="citation">(Hong and Li 2005)</span></td>
<td align="right">[P]</td>
</tr>
<tr class="even">
<td align="left">Directional Accuracy Tests</td>
<td align="left">dac_test</td>
<td align="left"><span class="citation">(Pesaran and Timmermann
1992)</span>,<br> <span class="citation">(Anatolyev and Gerko
2005)</span></td>
<td align="right">[H]</td>
</tr>
<tr class="odd">
<td align="left">Mincer-Zarnowitz Test</td>
<td align="left">minzar_test</td>
<td align="left"><span class="citation">(Mincer and Zarnowitz
1969)</span></td>
<td align="right">[W]</td>
</tr>
<tr class="even">
<td align="left">Expected Shortfall Test</td>
<td align="left">shortfall_de_test</td>
<td align="left"><span class="citation">(Du and Escanciano
2017)</span></td>
<td align="right">[LR]</td>
</tr>
<tr class="odd">
<td align="left">Value at Risk Test</td>
<td align="left">var_cp_test</td>
<td align="left"><span class="citation">(P. F. Christoffersen
1998)</span>,<br><span class="citation">(P. F. Christoffersen and
Pelletier 2004)</span></td>
<td align="right">[LR]</td>
</tr>
</tbody>
</table>
</div>
<p>One of the key features of the package includes customization of the
test output using the <code>as_flextable</code> method to generate
non-console compatible and nicely formatted tables. The next section
provides an overview of the tests together with examples.</p>
</div>
<div id="goodness-of-fit-tests" class="section level1">
<h1>Goodness of Fit Tests</h1>
<div id="gmm-orthogonality" class="section level2">
<h2>GMM Orthogonality</h2>
<p>The Generalized Method of Moments framework of <span class="citation">L. P. Hansen (1982)</span> provides for a set of
orthogonality conditions for testing the specification of a model. These
conditions test for how well a model captures a set of lower to higher
order moments and co-moments by testing the following hypothesis:</p>
<p><span class="math display">\[
\begin{aligned}
E&amp;\left[z_t\right]=0,\quad E\left[z_t^2-1\right]=0\\
E&amp;\left[z_t^3\right]=0,\quad E\left[z_t^3\right]-3=0\\
E&amp;\left[\left(z^2_t-1\right)\left(z_{t-j}^2-1\right)\right]=0,\quad
j=1,\ldots,m\\
E&amp;\left[\left(z^3_t\right)\left(z_{t-j}^3\right)\right]=0,\quad
j=1,\ldots,m\\
E&amp;\left[\left(z^4_t-3\right)\left(z_{t-j}^4-3\right)\right]=0,\quad
j=1,\ldots,m\\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(z_t\)</span> are the standardized
residuals from an estimated model, and <span class="math inline">\(m\)</span> the number of lags used for testing the
hypothesis.</p>
<p>Define the moment (M) generating conditions as:</p>
<p><span class="math display">\[
g_T\left(\theta\right) = \frac{1}{T}\sum^T_{t=1}M_t\left(\theta\right)
\]</span></p>
<p>with <span class="math inline">\(\theta\)</span> being the parameter
vector. For large T we expect that <span class="math inline">\(g_T\left(\theta\right)\)</span> converges to <span class="math inline">\(E\left[M_t\left(\theta\right)\right]\)</span>, and
should be equal to zero under a correctly specified model. The GMM
estimator of <span class="math inline">\(\theta\)</span> is obtained by
minimizing:</p>
<p><span class="math display">\[
g_T\left(\theta\right)&#39;S^{-1}g_T\left(\theta\right)
\]</span></p>
<p>where S is the weighting matrix and defined as</p>
<p><span class="math display">\[
S =
\frac{1}{T}\sum^T_{t=1}M_t\left(\theta\right)M_t\left(\theta\right)&#39;.
\]</span></p>
<p>which turns out to be the asymptotic covariance matrix.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>The test is conducted on individual moment conditions as a t-test
with <span class="math inline">\(T-1\)</span> degrees of freedom, on the
co-moment conditions as a Wald test<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> with <span class="math inline">\(j\)</span>
degrees of freedom, and joint tests on the co-moment conditions and all
conditions (<span class="math inline">\(J\)</span><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>) as Wald tests with
<span class="math inline">\(m\)</span> and <span class="math inline">\(4+3m\)</span> degrees of freedom,
respectively.</p>
<p>As an example, we use the SPY log returns to estimate an exponential
GARCH (2,1) model with Johnson’s SU distribution, and test all these
conditions using the <code>gmm_test</code>.</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">garch_modelspec</span>(spyr, <span class="at">model =</span> <span class="st">&quot;egarch&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="at">distribution =</span> <span class="st">&quot;jsu&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">estimate</span>(spec)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="fu">dskewness</span>(<span class="st">&quot;jsu&quot;</span>, <span class="at">skew =</span> <span class="fu">coef</span>(mod)[<span class="st">&quot;skew&quot;</span>], <span class="at">shape =</span> <span class="fu">coef</span>(mod)[<span class="st">&quot;shape&quot;</span>])</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>kurtosis <span class="ot">&lt;-</span> <span class="fu">dkurtosis</span>(<span class="st">&quot;jsu&quot;</span>, <span class="at">skew =</span> <span class="fu">coef</span>(mod)[<span class="st">&quot;skew&quot;</span>], <span class="at">shape =</span> <span class="fu">coef</span>(mod)[<span class="st">&quot;shape&quot;</span>]) <span class="sc">+</span> <span class="dv">3</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">gmm_test</span>(<span class="fu">residuals</span>(mod, <span class="at">standardize =</span> <span class="cn">TRUE</span>), <span class="at">lags =</span> <span class="dv">2</span>, <span class="at">skewness =</span> skewness, </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>                 <span class="at">kurtosis =</span> kurtosis, <span class="at">conf_level =</span> <span class="fl">0.95</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">print</span>(test)</span></code></pre></div>
</details>
<pre><code>## GMM Orthogonality Test
## Hypothesis(H0) :  E[Moment] = 0 
## 
##             Mean Std. Error  t value Pr(&gt;|t|)  
## M1     0.0004718    0.01152  0.04095  0.96734  
## M2     0.0081345    0.02585  0.31473  0.75297  
## M3    -0.1599486    0.15545 -1.02894  0.30354  
## M4     1.2079050    1.26430  0.95540  0.33941  
## Q2[J]         NA         NA  2.18549  0.33530  
## Q3[J]         NA         NA  4.74401  0.09329 .
## Q4[J]         NA         NA  1.60572  0.44805  
## J             NA         NA 11.04053  0.35437  
## 
## ---
## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>None of the p-values are below 5%, therefore we fail to reject the
null hypothesis. Notice that the joint conditions (Q2-Q4 and J) have no
Mean or Std.Error as these are vector valued. It is also possible to
create a nicer looking table, with symbols, using <a href="https://cran.r-project.org/package=flextable">flextable</a>, and
we also include the test paper reference in the footnote.</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">as_flextable</span>(test, <span class="at">include.decision =</span> <span class="cn">FALSE</span>, <span class="at">footnote.reference =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
<div class="tabwid"><style>.cl-92b41eb4{}.cl-92a9d0f8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-92a9d102{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-92b288ec{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-92b288f6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-92b288f7{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:0;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-92b29468{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29472{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29473{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29474{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29475{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b2947c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b2947d{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b2947e{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b2947f{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29480{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29486{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29487{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29488{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29489{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29490{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29491{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29492{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b29493{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b2949a{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b2949b{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b2949c{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b2949d{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294a4{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294a5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294a6{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294a7{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294ae{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294af{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294b0{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294b1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294b2{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294b8{width:0.803in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294b9{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294ba{width:0.837in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294c2{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-92b294c3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-92b41eb4"><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>GMM Orthogonality Test</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-92b29468"><p class="cl-92b288ec"><span class="cl-92a9d0f8">Moment</span></p></th><th class="cl-92b29472"><p class="cl-92b288f6"><span class="cl-92a9d0f8">Mean</span></p></th><th class="cl-92b29473"><p class="cl-92b288f6"><span class="cl-92a9d0f8">Std. Error</span></p></th><th class="cl-92b29474"><p class="cl-92b288f6"><span class="cl-92a9d0f8">t value</span></p></th><th class="cl-92b29475"><p class="cl-92b288f6"><span class="cl-92a9d0f8">Pr(&gt;|t|)</span></p></th><th class="cl-92b2947c"><p class="cl-92b288f7"><span class="cl-92a9d0f8"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-92b2947d"><p class="cl-92b288ec"><span class="cl-92a9d0f8"> </span><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" data-external="1"><span class="cl-92a9d0f8"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo fence="true">[</mo><msub><mi>z</mi><mi>t</mi></msub><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">E\left[z_t\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span></span></p></td><td class="cl-92b2947e"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.0005</span></p></td><td class="cl-92b2947f"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.0115</span></p></td><td class="cl-92b29480"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.0409</span></p></td><td class="cl-92b29486"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.9673</span></p></td><td class="cl-92b29487"><p class="cl-92b288f7"><span class="cl-92a9d102"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-92b2947d"><p class="cl-92b288ec"><span class="cl-92a9d0f8"> </span><span class="cl-92a9d0f8"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo fence="true">[</mo><msubsup><mi>z</mi><mi>t</mi><mn>2</mn></msubsup><mo>−</mo><mn>1</mn><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">E\left[z^2_t - 1\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p></td><td class="cl-92b2947e"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.0081</span></p></td><td class="cl-92b2947f"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.0258</span></p></td><td class="cl-92b29480"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.3147</span></p></td><td class="cl-92b29486"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.7530</span></p></td><td class="cl-92b29487"><p class="cl-92b288f7"><span class="cl-92a9d102"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-92b2947d"><p class="cl-92b288ec"><span class="cl-92a9d0f8"> </span><span class="cl-92a9d0f8"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo fence="true">[</mo><msubsup><mi>z</mi><mi>t</mi><mn>3</mn></msubsup><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">E\left[z^3_t\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p></td><td class="cl-92b2947e"><p class="cl-92b288f6"><span class="cl-92a9d0f8">-0.1599</span></p></td><td class="cl-92b2947f"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.1554</span></p></td><td class="cl-92b29480"><p class="cl-92b288f6"><span class="cl-92a9d0f8">-1.0289</span></p></td><td class="cl-92b29486"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.3035</span></p></td><td class="cl-92b29487"><p class="cl-92b288f7"><span class="cl-92a9d102"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-92b2947d"><p class="cl-92b288ec"><span class="cl-92a9d0f8"> </span><span class="cl-92a9d0f8"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo fence="true">[</mo><msubsup><mi>z</mi><mi>t</mi><mn>4</mn></msubsup><mo>−</mo><mn>3</mn><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">E\left[z^4_t - 3\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">3</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p></td><td class="cl-92b2947e"><p class="cl-92b288f6"><span class="cl-92a9d0f8">1.2079</span></p></td><td class="cl-92b2947f"><p class="cl-92b288f6"><span class="cl-92a9d0f8">1.2643</span></p></td><td class="cl-92b29480"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.9554</span></p></td><td class="cl-92b29486"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.3394</span></p></td><td class="cl-92b29487"><p class="cl-92b288f7"><span class="cl-92a9d102"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-92b2947d"><p class="cl-92b288ec"><span class="cl-92a9d0f8"> </span><span class="cl-92a9d0f8"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo fence="true">[</mo><mo stretchy="false">(</mo><msubsup><mi>z</mi><mi>t</mi><mn>2</mn></msubsup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msubsup><mi>z</mi><mrow><mi>t</mi><mo>−</mo><mi>j</mi></mrow><mn>2</mn></msubsup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">E\left[(z^2_t - 1)(z^2_{t-j} - 1)\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2448em;vertical-align:-0.3948em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p></td><td class="cl-92b2947e"><p class="cl-92b288f6"><span class="cl-92a9d0f8"></span></p></td><td class="cl-92b2947f"><p class="cl-92b288f6"><span class="cl-92a9d0f8"></span></p></td><td class="cl-92b29480"><p class="cl-92b288f6"><span class="cl-92a9d0f8">2.1855</span></p></td><td class="cl-92b29486"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.3353</span></p></td><td class="cl-92b29487"><p class="cl-92b288f7"><span class="cl-92a9d102"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-92b2947d"><p class="cl-92b288ec"><span class="cl-92a9d0f8"> </span><span class="cl-92a9d0f8"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo fence="true">[</mo><mo stretchy="false">(</mo><msubsup><mi>z</mi><mi>t</mi><mn>3</mn></msubsup><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msubsup><mi>z</mi><mrow><mi>t</mi><mo>−</mo><mi>j</mi></mrow><mn>3</mn></msubsup><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">E\left[(z^3_t)(z^3_{t-j})\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2448em;vertical-align:-0.3948em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p></td><td class="cl-92b2947e"><p class="cl-92b288f6"><span class="cl-92a9d0f8"></span></p></td><td class="cl-92b2947f"><p class="cl-92b288f6"><span class="cl-92a9d0f8"></span></p></td><td class="cl-92b29480"><p class="cl-92b288f6"><span class="cl-92a9d0f8">4.7440</span></p></td><td class="cl-92b29486"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.0933</span></p></td><td class="cl-92b29487"><p class="cl-92b288f7"><span class="cl-92a9d102">.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-92b2947d"><p class="cl-92b288ec"><span class="cl-92a9d0f8"> </span><span class="cl-92a9d0f8"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo fence="true">[</mo><mo stretchy="false">(</mo><msubsup><mi>z</mi><mi>t</mi><mn>4</mn></msubsup><mo>−</mo><mn>3</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msubsup><mi>z</mi><mrow><mi>t</mi><mo>−</mo><mi>j</mi></mrow><mn>4</mn></msubsup><mo>−</mo><mn>3</mn><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">E\left[(z^4_t - 3)(z^4_{t-j} - 3)\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2448em;vertical-align:-0.3948em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p></td><td class="cl-92b2947e"><p class="cl-92b288f6"><span class="cl-92a9d0f8"></span></p></td><td class="cl-92b2947f"><p class="cl-92b288f6"><span class="cl-92a9d0f8"></span></p></td><td class="cl-92b29480"><p class="cl-92b288f6"><span class="cl-92a9d0f8">1.6057</span></p></td><td class="cl-92b29486"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.4480</span></p></td><td class="cl-92b29487"><p class="cl-92b288f7"><span class="cl-92a9d102"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-92b29488"><p class="cl-92b288ec"><span class="cl-92a9d0f8"> </span><span class="cl-92a9d0f8"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span></span></span></span></span></p></td><td class="cl-92b29489"><p class="cl-92b288f6"><span class="cl-92a9d0f8"></span></p></td><td class="cl-92b29490"><p class="cl-92b288f6"><span class="cl-92a9d0f8"></span></p></td><td class="cl-92b29491"><p class="cl-92b288f6"><span class="cl-92a9d0f8">11.0405</span></p></td><td class="cl-92b29492"><p class="cl-92b288f6"><span class="cl-92a9d0f8">0.3544</span></p></td><td class="cl-92b29493"><p class="cl-92b288f7"><span class="cl-92a9d102"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-92b2949a"><p class="cl-92b288ec"><span class="cl-92a9d0f8">Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-92b294a6"><p class="cl-92b288ec"><span class="cl-92a9d0f8">Hypothesis(H0) : E[Moment] = 0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-92b294b2"><p class="cl-92b288ec"><span class="cl-92a9d0f8">Reference: Hansen,L.P. (1982), Large sample properties of generalized method of moments estimators, Econometrica, 50(4), 1029--1054.</span></p></td></tr></tfoot></table></div>
</div>
<div id="non-parametric-density-test" class="section level2">
<h2>Non Parametric Density Test</h2>
<p><span class="citation">Hong and Li (2005)</span> introduced a
nonparametric portmanteau test, building on the work of <span class="citation">Ait-Sahalia (1996)</span>, which tests the joint
hypothesis of i.i.d <strong>and</strong> <span class="math inline">\(U(0,1)\)</span> for the sequence <span class="math inline">\(x_t\)</span>. As noted by the authors, testing
<span class="math inline">\(x_t\)</span> using a standard
goodness-of-fit test (such as the Kolmogorov-Smirnov) would only check
the <span class="math inline">\(U(0,1)\)</span> assumption under i.i.d.
and not the joint assumption of <span class="math inline">\(U(0,1)\)</span> and i.i.d. Their approach is to
compare a kernel estimator <span class="math inline">\(\hat
g_j\left(x_1,x_2\right)\)</span> for the joint density <span class="math inline">\(g_j\left(x_1,x_2\right)\)</span> of the pair <span class="math inline">\(\left\{ {x_t,x_{t-j}} \right\}\)</span> (where
<span class="math inline">\(j\)</span> is the lag order) with unity, the
product of two <span class="math inline">\(U(0,1)\)</span> densities.
Given a sample size <span class="math inline">\(n\)</span> and lag order
<span class="math inline">\(j&gt;0\)</span>, their joint density
estimator is:</p>
<p><span class="math display">\[
{{\hat g}_j}\left( {{x_1},{x_2}} \right) \equiv {\left( {n - j}
\right)^{ - 1}}\sum\limits_{t = j + 1}^n {{K_h}\left( {{x_1},{{\hat
X}_t}} \right){K_h}\left( {{x_2},{{\hat X}_{t - j}}} \right)}
\]</span> where <span class="math inline">\({{\hat X}_t} = {X_t}\left(
{\hat \theta } \right)\)</span>, and <span class="math inline">\(\hat
\theta\)</span> is a <span class="math inline">\(\sqrt n\)</span>
consistent estimator of <span class="math inline">\(\theta_0\)</span>.
The function <span class="math inline">\(K_h\)</span> is a boundary
modified kernel defined as:</p>
<p><span class="math display">\[
K_{h}\left({x,y}\right)\equiv\left\{{\matrix{
{h^{-1}k\left({{{x-y}\over{h}}}\right)/\int_{-\left({x/h}\right)}^{1}{k\left({u}\right)du},\quad
\textbf{if}\quad x\in\left[{0,h}\right)}\cr
{h^{-1}k\left({{{x-y}\over{h}}}\right),\quad \textbf{if}\quad
x\in\left[{h,1-h}\right]}\cr
{h^{-1}k\left({{{x-y}\over{h}}}\right)/\int_{-1}^{\left({1-x}\right)/h}{k\left({u}\right)du,\quad
\textbf{if}\quad x\in\left({1-h,1}\right]}}\cr
}}\right.
\]</span></p>
<p>where <span class="math inline">\(h\equiv h\left(n \right)\)</span>
is a bandwidth such that <span class="math inline">\(h\rightarrow
0\)</span> as <span class="math inline">\(n\rightarrow \infty\)</span>,
and the kernel <span class="math inline">\(k(.)\)</span> is a
pre-specified symmetric probability density, which is implemented as
suggested by the authors using a quartic kernel,</p>
<p><span class="math display">\[
k\left( u \right) = \frac{{15}}{{16}}{\left( {1 - {u^2}}
\right)^2}{\bf{1}}\left( {\left| u \right| \le 1} \right),
\]</span></p>
<p>where <span class="math inline">\(\bf{1}\left(.\right)\)</span> is
the indicator function. Their portmanteau test statistic is defined
as:</p>
<p><span class="math display">\[
\hat W\left(p \right) \equiv {p^{ - 1/2}}\sum\limits_{j = 1}^p {\hat
Q\left( j \right)},
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\hat Q\left( j \right) \equiv {{\left[ {\left( {n - j} \right)h\hat
M\left( j \right) - A_h^0} \right]} \mathord{\left/
{\vphantom {{\left[ {\left( {n - j} \right)h\hat M\left( j \right) -
A_h^0} \right]} {V_0^{1/2}}}} \right.} {V_0^{1/2}}},
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\hat M\left( j \right) \equiv \int_0^1 {\int_0^1 {{{\left[ {{{\hat
g}_j}\left( {{x_1},{x_2}} \right) - 1} \right]}^2}d{x_1}d{x_2}} }.
\]</span></p>
<p>The centering and scaling factors <span class="math inline">\(A_h^0\)</span> and <span class="math inline">\(V_0\)</span> are defined as: <span class="math display">\[
\begin{array}{l}
A_h^0 \equiv {\left[ {\left( {{h^{ - 1}} - 2} \right)\int_{ - 1}^1
{{k^2}\left( u \right)du + 2\int_0^1 {\int_{ - 1}^b {k_b^2\left( u
\right)dudb} } } } \right]^2} - 1\\
{V_0} \equiv 2{\left[ {\int_{ - 1}^1 {{{\left[ {\int_{ - 1}^1 {k\left(
{u + v} \right)k\left( v \right)dv} } \right]}^2}du} } \right]^2}
\end{array}
\]</span></p>
<p>where,</p>
<p><span class="math display">\[
{k_b}\left( . \right) \equiv {{k\left( . \right)}
\mathord{\left/{\vphantom {{k\left( . \right)} {\int_{ - 1}^b {k\left( v
\right)dv} }}} \right.} {\int_{ - 1}^b {k\left( v \right)dv} }}.
\]</span></p>
<p>Under the correct model specification, the authors show that <span class="math inline">\(\hat W\left( p \right)\rightarrow
N\left(0,1\right)\)</span> in distribution. Because negative values of
the test statistic only occur under the Null Hypothesis of a correctly
specified model, the authors indicate that only upper tail critical
values need be considered. The test is quite robust to model
misspecification as parameter uncertainty has no impact on the
asymptotic distribution of the test statistic as long as the parameters
are <span class="math inline">\(\sqrt n\)</span> consistent. Finally, in
order to explore possible causes of misspecification when the statistic
rejects a model, the authors develop the following test statistic:</p>
<p><span class="math display">\[
M\left({m,l}\right)\equiv\left[{\sum\limits_{j=1}^{n-1}{w^{2}\left({j/p}\right)\left({n-j}\right){\rm
{\hat\rho}}_{ml}^{2}\left({j}\right)-\sum\limits_{j=1}^{n-1}{w^{2}\left({j/p}\right)}}}\right]/{\left[{2\sum\limits_{j=1}^{n-2}{w^{4}\left({j/p}\right)}}\right]}^{1/2}
\]</span></p>
<p>where <span class="math inline">\({{\hat \rho }_{ml}}\left( j
\right)\)</span> is the sample cross-correlation between <span class="math inline">\(\hat X_t^m\)</span> and <span class="math inline">\(\hat X_{t - \left| j \right|}^l\)</span>, and
<span class="math inline">\(w\left(.\right)\)</span> is a weighting
function of lag order j, and as suggested by the authors implemented as
the Bartlett kernel. As in the <span class="math inline">\(\hat W\left(
p \right)\)</span> statistic, the asymptotic distribution of <span class="math inline">\(M\left( {m,l} \right)\)</span> is <span class="math inline">\(N\left(0,1\right)\)</span> and upper critical
values should be considered.</p>
<p>We consider an example below using the SPY dataset and a short
sub-sample. Note that the critical value are the upper quantiles of a
standardized normal distribution and we use a confidence level of 95%
for this example, hence, based on the way the test is conducted, we
reject the null of the statistic if it is higher than this value
(<code>qnorm(0.95)</code>).</p>
<p>Based on the example shown, we fail to reject the null of a correctly
specified model for this short sub-sample, but caution that using the
full sample would have led to an outright rejection, raising questions
about parameter stability (next section) and/or structural breaks in the
series.</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">garch_modelspec</span>(spyr[<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>], <span class="at">model =</span> <span class="st">&quot;egarch&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="at">distribution =</span> <span class="st">&quot;jsu&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">estimate</span>(spec)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">residuals</span>(mod, <span class="at">standardize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pdist</span>(<span class="st">&quot;jsu&quot;</span>, z, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">skew =</span> <span class="fu">coef</span>(mod)[<span class="st">&quot;skew&quot;</span>], <span class="at">shape =</span> <span class="fu">coef</span>(mod)[<span class="st">&quot;shape&quot;</span>])</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">as_flextable</span>(<span class="fu">hongli_test</span>(<span class="fu">as.numeric</span>(p), <span class="at">lags =</span> <span class="dv">4</span>, <span class="at">conf_level =</span> <span class="fl">0.95</span>), <span class="at">include.decision =</span> T, <span class="at">footnote.reference =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
<div class="tabwid"><style>.cl-9304cbc0{}.cl-93029314{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-930370ae{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-930370af{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-93037aa4{width:1.027in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037aa5{width:1.341in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037aa6{width:1.485in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037aae{width:1.714in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037aaf{width:1.027in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ab0{width:1.341in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ab8{width:1.485in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ab9{width:1.714in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037aba{width:1.027in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037abb{width:1.341in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037abc{width:1.485in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037abd{width:1.714in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ac2{width:1.027in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ac3{width:1.341in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ac4{width:1.485in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037acc{width:1.714in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037acd{width:1.027in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ace{width:1.341in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037acf{width:1.485in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ad0{width:1.714in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ad6{width:1.027in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ad7{width:1.341in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ad8{width:1.485in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93037ad9{width:1.714in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-9304cbc0"><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>Hong-Li Non-Parametric Density Test</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-93037aa4"><p class="cl-930370ae"><span class="cl-93029314">Test</span></p></th><th class="cl-93037aa5"><p class="cl-930370af"><span class="cl-93029314">Statistic (z)</span></p></th><th class="cl-93037aa6"><p class="cl-930370af"><span class="cl-93029314">Critical Value</span></p></th><th class="cl-93037aae"><p class="cl-930370ae"><span class="cl-93029314">Decision</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-93037aaf"><p class="cl-930370ae"><span class="cl-93029314">M(1,1)</span></p></td><td class="cl-93037ab0"><p class="cl-930370af"><span class="cl-93029314">-0.9449</span></p></td><td class="cl-93037ab8"><p class="cl-930370af"><span class="cl-93029314">1.6449</span></p></td><td class="cl-93037ab9"><p class="cl-930370ae"><span class="cl-93029314">Fail to Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93037aba"><p class="cl-930370ae"><span class="cl-93029314">M(2,2)</span></p></td><td class="cl-93037abb"><p class="cl-930370af"><span class="cl-93029314">0.2038</span></p></td><td class="cl-93037abc"><p class="cl-930370af"><span class="cl-93029314">1.6449</span></p></td><td class="cl-93037abd"><p class="cl-930370ae"><span class="cl-93029314">Fail to Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93037ac2"><p class="cl-930370ae"><span class="cl-93029314">M(3,3)</span></p></td><td class="cl-93037ac3"><p class="cl-930370af"><span class="cl-93029314">-0.1175</span></p></td><td class="cl-93037ac4"><p class="cl-930370af"><span class="cl-93029314">1.6449</span></p></td><td class="cl-93037acc"><p class="cl-930370ae"><span class="cl-93029314">Fail to Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93037aaf"><p class="cl-930370ae"><span class="cl-93029314">M(4,4)</span></p></td><td class="cl-93037ab0"><p class="cl-930370af"><span class="cl-93029314">-0.6516</span></p></td><td class="cl-93037ab8"><p class="cl-930370af"><span class="cl-93029314">1.6449</span></p></td><td class="cl-93037ab9"><p class="cl-930370ae"><span class="cl-93029314">Fail to Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93037aaf"><p class="cl-930370ae"><span class="cl-93029314">M(1,2)</span></p></td><td class="cl-93037ab0"><p class="cl-930370af"><span class="cl-93029314">-0.7576</span></p></td><td class="cl-93037ab8"><p class="cl-930370af"><span class="cl-93029314">1.6449</span></p></td><td class="cl-93037ab9"><p class="cl-930370ae"><span class="cl-93029314">Fail to Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93037aaf"><p class="cl-930370ae"><span class="cl-93029314">M(2,1)</span></p></td><td class="cl-93037ab0"><p class="cl-930370af"><span class="cl-93029314">0.2697</span></p></td><td class="cl-93037ab8"><p class="cl-930370af"><span class="cl-93029314">1.6449</span></p></td><td class="cl-93037ab9"><p class="cl-930370ae"><span class="cl-93029314">Fail to Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93037acd"><p class="cl-930370ae"><span class="cl-93029314">J</span></p></td><td class="cl-93037ace"><p class="cl-930370af"><span class="cl-93029314">-1.1106</span></p></td><td class="cl-93037acf"><p class="cl-930370af"><span class="cl-93029314">1.6449</span></p></td><td class="cl-93037ad0"><p class="cl-930370ae"><span class="cl-93029314">Fail to Reject H0</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-93037ad6"><p class="cl-930370ae"><span class="cl-93029314">Confidence Level (%) : 95</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-93037ad6"><p class="cl-930370ae"><span class="cl-93029314">Hypothesis(H0) : Correctly Specified</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-93037ad6"><p class="cl-930370ae"><span class="cl-93029314">References: </span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-93037ad6"><p class="cl-930370ae"><span class="cl-93029314">Hong, Y., and Li, H. (2005), Nonparametric specification testing for continuous-time models with applications to term structure of interest rates, Review of Financial Studies, 18(1), 37--84.</span></p></td></tr></tfoot></table></div>
</div>
<div id="parameter-constancy" class="section level2">
<h2>Parameter Constancy</h2>
<p>The parameter constancy tests of <span class="citation">Nyblom
(1989)</span> and <span class="citation">B. E. Hansen (1992)</span> are
Lagrange multiplier parameter stability tests. The test of <span class="citation">Nyblom (1989)</span> tests the null hypothesis that all
parameters are constant against the alternative that they follow a
martingale process, whilst that of <span class="citation">B. E. Hansen
(1992)</span> tests the null hypothesis of constancy for individual
parameters. The distribution of the statistic is non-standard, and
related to the distribution of squares of independent Brownian bridges
which has the following series expansion<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>:</p>
<p><span class="math display">\[
\sum^{\infty}_{k=1}\frac{1}{\left(\pi
k\right)^2}\chi^2_{k}\left(p\right)
\]</span></p>
<p>where <span class="math inline">\(p\)</span> are the number of
parameters. <span class="citation">B. E. Hansen (1992)</span> provides a
table with critical values for up to 20 parameters based on simulation
which has been used extensively as a reference point when conducting
this test. Instead, the <code>tstests</code> package uses an internal
dataset generated by simulation for up to 40 parameters in addition to a
kernel smoothed density in order to generate the p-values directly. It
should be noted that neither the individual nor joint tests provide any
information about the location of breaks, and the distribution is only
valid for stationary data.</p>
<p>To illustrate the use of the test, we continue with the same model as
in the previous section, and turn on the argument to provide guidance on
whether to reject the null hypothesis at the 5% level of
significance.</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">garch_modelspec</span>(spyr, <span class="at">model =</span> <span class="st">&quot;egarch&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="at">distribution =</span> <span class="st">&quot;jsu&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">estimate</span>(spec)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">nyblom_test</span>(<span class="fu">residuals</span>(mod, <span class="at">standardize =</span> <span class="cn">TRUE</span>), <span class="at">scores =</span> <span class="fu">estfun</span>(mod), </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                    <span class="at">parameter_names =</span> <span class="fu">names</span>(<span class="fu">coef</span>(mod)), </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                    <span class="at">parameter_symbols =</span> mod<span class="sc">$</span>parmatrix[estimate <span class="sc">==</span> <span class="dv">1</span>]<span class="sc">$</span>symbol)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">as_flextable</span>(test, <span class="at">use.symbols =</span> <span class="cn">TRUE</span>, <span class="at">footnote.reference =</span> <span class="cn">TRUE</span>, <span class="at">include.decision =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
<div class="tabwid"><style>.cl-94615eac{}.cl-945ea68a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-945ea694{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-945ff2f6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-945ff300{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-945ff301{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:0;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-945ffd64{width:1.428in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd6e{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd6f{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd70{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd71{width:1.514in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd78{width:1.428in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd79{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd7a{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd7b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd82{width:1.514in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd83{width:1.428in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd84{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd85{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd8c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd8d{width:1.514in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd8e{width:1.428in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd96{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffd97{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffda0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffda1{width:1.514in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffdaa{width:1.428in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffdab{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffdb4{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffdb5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffdb6{width:1.514in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffdb7{width:1.428in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffdbe{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffdbf{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffdc0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-945ffdc1{width:1.514in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-94615eac"><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>Nyblom-Hansen Parameter Constancy Test</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-945ffd64"><p class="cl-945ff2f6"><span class="cl-945ea68a"></span></p></th><th class="cl-945ffd6e"><p class="cl-945ff300"><span class="cl-945ea68a">Statistic</span></p></th><th class="cl-945ffd6f"><p class="cl-945ff300"><span class="cl-945ea68a">Pr(&gt;t)</span></p></th><th class="cl-945ffd70"><p class="cl-945ff301"><span class="cl-945ea68a"></span></p></th><th class="cl-945ffd71"><p class="cl-945ff2f6"><span class="cl-945ea68a">Decision(5%)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-945ffd78"><p class="cl-945ff2f6"><span class="cl-945ea68a"> </span><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" data-external="1"><span class="cl-945ea68a"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span></span></p></td><td class="cl-945ffd79"><p class="cl-945ff300"><span class="cl-945ea68a">0.1599</span></p></td><td class="cl-945ffd7a"><p class="cl-945ff300"><span class="cl-945ea68a">0.3499</span></p></td><td class="cl-945ffd7b"><p class="cl-945ff301"><span class="cl-945ea694"></span></p></td><td class="cl-945ffd82"><p class="cl-945ff2f6"><span class="cl-945ea68a">Fail to Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-945ffd78"><p class="cl-945ff2f6"><span class="cl-945ea68a"> </span><span class="cl-945ea68a"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span></span></p></td><td class="cl-945ffd79"><p class="cl-945ff300"><span class="cl-945ea68a">0.5565</span></p></td><td class="cl-945ffd7a"><p class="cl-945ff300"><span class="cl-945ea68a">0.0285</span></p></td><td class="cl-945ffd7b"><p class="cl-945ff301"><span class="cl-945ea694">*</span></p></td><td class="cl-945ffd82"><p class="cl-945ff2f6"><span class="cl-945ea68a">Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-945ffd78"><p class="cl-945ff2f6"><span class="cl-945ea68a"> </span><span class="cl-945ea68a"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\alpha_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p></td><td class="cl-945ffd79"><p class="cl-945ff300"><span class="cl-945ea68a">0.7846</span></p></td><td class="cl-945ffd7a"><p class="cl-945ff300"><span class="cl-945ea68a">0.0079</span></p></td><td class="cl-945ffd7b"><p class="cl-945ff301"><span class="cl-945ea694">**</span></p></td><td class="cl-945ffd82"><p class="cl-945ff2f6"><span class="cl-945ea68a">Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-945ffd78"><p class="cl-945ff2f6"><span class="cl-945ea68a"> </span><span class="cl-945ea68a"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\alpha_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p></td><td class="cl-945ffd79"><p class="cl-945ff300"><span class="cl-945ea68a">0.7569</span></p></td><td class="cl-945ffd7a"><p class="cl-945ff300"><span class="cl-945ea68a">0.0092</span></p></td><td class="cl-945ffd7b"><p class="cl-945ff301"><span class="cl-945ea694">**</span></p></td><td class="cl-945ffd82"><p class="cl-945ff2f6"><span class="cl-945ea68a">Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-945ffd78"><p class="cl-945ff2f6"><span class="cl-945ea68a"> </span><span class="cl-945ea68a"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\gamma_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p></td><td class="cl-945ffd79"><p class="cl-945ff300"><span class="cl-945ea68a">0.4700</span></p></td><td class="cl-945ffd7a"><p class="cl-945ff300"><span class="cl-945ea68a">0.0473</span></p></td><td class="cl-945ffd7b"><p class="cl-945ff301"><span class="cl-945ea694">*</span></p></td><td class="cl-945ffd82"><p class="cl-945ff2f6"><span class="cl-945ea68a">Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-945ffd78"><p class="cl-945ff2f6"><span class="cl-945ea68a"> </span><span class="cl-945ea68a"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\gamma_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p></td><td class="cl-945ffd79"><p class="cl-945ff300"><span class="cl-945ea68a">0.0714</span></p></td><td class="cl-945ffd7a"><p class="cl-945ff300"><span class="cl-945ea68a">0.7169</span></p></td><td class="cl-945ffd7b"><p class="cl-945ff301"><span class="cl-945ea694"></span></p></td><td class="cl-945ffd82"><p class="cl-945ff2f6"><span class="cl-945ea68a">Fail to Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-945ffd78"><p class="cl-945ff2f6"><span class="cl-945ea68a"> </span><span class="cl-945ea68a"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p></td><td class="cl-945ffd79"><p class="cl-945ff300"><span class="cl-945ea68a">0.5187</span></p></td><td class="cl-945ffd7a"><p class="cl-945ff300"><span class="cl-945ea68a">0.0354</span></p></td><td class="cl-945ffd7b"><p class="cl-945ff301"><span class="cl-945ea694">*</span></p></td><td class="cl-945ffd82"><p class="cl-945ff2f6"><span class="cl-945ea68a">Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-945ffd78"><p class="cl-945ff2f6"><span class="cl-945ea68a"> </span><span class="cl-945ea68a"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ζ</mi></mrow><annotation encoding="application/x-tex">\zeta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07378em;">ζ</span></span></span></span></span></p></td><td class="cl-945ffd79"><p class="cl-945ff300"><span class="cl-945ea68a">1.8639</span></p></td><td class="cl-945ffd7a"><p class="cl-945ff300"><span class="cl-945ea68a">0.0000</span></p></td><td class="cl-945ffd7b"><p class="cl-945ff301"><span class="cl-945ea694">***</span></p></td><td class="cl-945ffd82"><p class="cl-945ff2f6"><span class="cl-945ea68a">Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-945ffd78"><p class="cl-945ff2f6"><span class="cl-945ea68a"> </span><span class="cl-945ea68a"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi></mrow><annotation encoding="application/x-tex">\nu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.06366em;">ν</span></span></span></span></span></p></td><td class="cl-945ffd79"><p class="cl-945ff300"><span class="cl-945ea68a">0.8672</span></p></td><td class="cl-945ffd7a"><p class="cl-945ff300"><span class="cl-945ea68a">0.0050</span></p></td><td class="cl-945ffd7b"><p class="cl-945ff301"><span class="cl-945ea694">**</span></p></td><td class="cl-945ffd82"><p class="cl-945ff2f6"><span class="cl-945ea68a">Reject H0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-945ffd83"><p class="cl-945ff2f6"><span class="cl-945ea68a"> </span><span class="cl-945ea68a"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">J</mi></mrow><annotation encoding="application/x-tex">\mathrm{J}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathrm">J</span></span></span></span></span></p></td><td class="cl-945ffd84"><p class="cl-945ff300"><span class="cl-945ea68a">5.3285</span></p></td><td class="cl-945ffd85"><p class="cl-945ff300"><span class="cl-945ea68a">0.0000</span></p></td><td class="cl-945ffd8c"><p class="cl-945ff301"><span class="cl-945ea694">***</span></p></td><td class="cl-945ffd8d"><p class="cl-945ff2f6"><span class="cl-945ea68a">Reject H0</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-945ffd8e"><p class="cl-945ff2f6"><span class="cl-945ea68a">Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-945ffdaa"><p class="cl-945ff2f6"><span class="cl-945ea68a">Hypothesis(H0) : Constant Parameters</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-945ffdb7"><p class="cl-945ff2f6"><span class="cl-945ea68a">Reference: Nyblom,J. (1989), Testing for the constancy of parameters over time, Journal of the American Statistical Association, 405, 223--230.</span></p></td></tr></tfoot></table></div>
<p>The table indicates that individually we can reject the null of
parameter constancy on most of the parameters at the 5% level as well as
jointly (<strong>J</strong>).</p>
</div>
<div id="sign-bias" class="section level2">
<h2>Sign Bias</h2>
<p>The sign bias test of <span class="citation">Engle and Ng
(1993)</span> evaluates the presence of leverage effects in the
standardized residuals (to capture possible misspecification of a GARCH
model), by regressing the squared standardized residuals on lagged
negative and positive shocks as follows:</p>
<p><span class="math display">\[
z^2_t = c_0 + S^{-}_{t-1} +  c_2 S^{-}_{t-1}\varepsilon_{t-1} +
c_3 S^{+}_{t-1}\varepsilon_{t-1} + u_t
\]</span></p>
<p>where <span class="math inline">\(S^{-}_{t-1} =
I_{\varepsilon_{t-1}&lt;0}\)</span>, <span class="math inline">\(S^{+}_{t-1} = I_{\varepsilon_{t-1}\ge0}\)</span>.
and <span class="math inline">\(\varepsilon_t\)</span> the model
residuals. The null hypothesis is that all coefficients <span class="math inline">\(\{c_1,c_2,c_3\}\)</span> are individually and
jointly zero. The joint test is a Wald test distributed as <span class="math inline">\(\chi^2(3)\)</span>.</p>
<p>The table below shows the output of this test on the residuals of the
model used so far, where the p-values indicate that we cannot reject the
null of no sign bias either individually or jointly.</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">signbias_test</span>(<span class="fu">residuals</span>(mod), <span class="at">sigma =</span> <span class="fu">sigma</span>(mod))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">as_flextable</span>(test, <span class="at">use.symbols =</span> <span class="cn">TRUE</span>, <span class="at">footnote.reference =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</details>
<div class="tabwid"><style>.cl-947332e4{}.cl-9470a40c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9470a416{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9471cf58{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9471cf62{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9471cf63{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:0;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9471daca{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dad4{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dad5{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dad6{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dad7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dade{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dadf{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dae0{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dae1{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dae8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dae9{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471daea{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471daeb{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471daec{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471daed{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471daf2{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471daf3{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471daf4{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dafc{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dafd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471dafe{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471db06{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471db07{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471db08{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471db09{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471db10{width:1.328in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471db11{width:0.88in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471db12{width:0.939in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471db13{width:0.752in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9471db14{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-947332e4"><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>Sign Bias Test</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-9471daca"><p class="cl-9471cf58"><span class="cl-9470a40c"></span></p></th><th class="cl-9471dad4"><p class="cl-9471cf62"><span class="cl-9470a40c">Estimate</span></p></th><th class="cl-9471dad5"><p class="cl-9471cf62"><span class="cl-9470a40c">Std. Error</span></p></th><th class="cl-9471dad6"><p class="cl-9471cf62"><span class="cl-9470a40c">t value</span></p></th><th class="cl-9471dad6"><p class="cl-9471cf62"><span class="cl-9470a40c">Pr(&gt;|t|)</span></p></th><th class="cl-9471dad7"><p class="cl-9471cf63"><span class="cl-9470a40c"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-9471dade"><p class="cl-9471cf58"><span class="cl-9470a40c"> </span><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" data-external="1"><span class="cl-9470a40c"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>S</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mo lspace="0em" rspace="0em">−</mo></msubsup></mrow><annotation encoding="application/x-tex">S^{-}_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1361em;vertical-align:-0.3246em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8115em;"><span style="top:-2.4337em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3246em;"><span></span></span></span></span></span></span></span></span></span></span></p></td><td class="cl-9471dadf"><p class="cl-9471cf62"><span class="cl-9470a40c">0.0648</span></p></td><td class="cl-9471dae0"><p class="cl-9471cf62"><span class="cl-9470a40c">0.0693</span></p></td><td class="cl-9471dae1"><p class="cl-9471cf62"><span class="cl-9470a40c">0.9347</span></p></td><td class="cl-9471dae1"><p class="cl-9471cf62"><span class="cl-9470a40c">0.3500</span></p></td><td class="cl-9471dae8"><p class="cl-9471cf63"><span class="cl-9470a416"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9471dade"><p class="cl-9471cf58"><span class="cl-9470a40c"> </span><span class="cl-9470a40c"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>S</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mo lspace="0em" rspace="0em">−</mo></msubsup><msub><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">S^{-}_{t-1}\varepsilon_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1361em;vertical-align:-0.3246em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8115em;"><span style="top:-2.4337em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3246em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span></p></td><td class="cl-9471dadf"><p class="cl-9471cf62"><span class="cl-9470a40c">3.9303</span></p></td><td class="cl-9471dae0"><p class="cl-9471cf62"><span class="cl-9470a40c">3.9425</span></p></td><td class="cl-9471dae1"><p class="cl-9471cf62"><span class="cl-9470a40c">0.9969</span></p></td><td class="cl-9471dae1"><p class="cl-9471cf62"><span class="cl-9470a40c">0.3189</span></p></td><td class="cl-9471dae8"><p class="cl-9471cf63"><span class="cl-9470a416"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9471dade"><p class="cl-9471cf58"><span class="cl-9470a40c"> </span><span class="cl-9470a40c"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>S</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mo lspace="0em" rspace="0em">+</mo></msubsup><msub><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">S^{+}_{t-1}\varepsilon_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1361em;vertical-align:-0.3246em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8115em;"><span style="top:-2.4337em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3246em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span></p></td><td class="cl-9471dadf"><p class="cl-9471cf62"><span class="cl-9470a40c">3.4217</span></p></td><td class="cl-9471dae0"><p class="cl-9471cf62"><span class="cl-9470a40c">4.2902</span></p></td><td class="cl-9471dae1"><p class="cl-9471cf62"><span class="cl-9470a40c">0.7976</span></p></td><td class="cl-9471dae1"><p class="cl-9471cf62"><span class="cl-9470a40c">0.4251</span></p></td><td class="cl-9471dae8"><p class="cl-9471cf63"><span class="cl-9470a416"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9471dae9"><p class="cl-9471cf58"><span class="cl-9470a40c"> </span><span class="cl-9470a40c"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" data-external="1">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">J</mi></mrow><annotation encoding="application/x-tex">\mathrm{J}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathrm">J</span></span></span></span></span></p></td><td class="cl-9471daea"><p class="cl-9471cf62"><span class="cl-9470a40c"></span></p></td><td class="cl-9471daeb"><p class="cl-9471cf62"><span class="cl-9470a40c"></span></p></td><td class="cl-9471daec"><p class="cl-9471cf62"><span class="cl-9470a40c">1.6447</span></p></td><td class="cl-9471daec"><p class="cl-9471cf62"><span class="cl-9470a40c">0.6493</span></p></td><td class="cl-9471daed"><p class="cl-9471cf63"><span class="cl-9470a416"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-9471daf2"><p class="cl-9471cf58"><span class="cl-9470a40c">Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-9471dafe"><p class="cl-9471cf58"><span class="cl-9470a40c">Hypothesis(H0) : No sign bias</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-9471db10"><p class="cl-9471cf58"><span class="cl-9470a40c">Reference: Engle RF, Ng VK (1993). Measuring and testing the impact of news on volatility. The Journal of Finance, 48(5), 1749--1778.</span></p></td></tr></tfoot></table></div>
</div>
</div>
<div id="forecast-evaluation-tests" class="section level1">
<h1>Forecast Evaluation Tests</h1>
<div id="density-forecast" class="section level2">
<h2>Density Forecast</h2>
<p>A novel method to analyze how well a conditional density fits the
underlying data is through the probability integral transformation
(<strong>PIT</strong>) discussed in <span class="citation">Rosenblatt
(1952)</span> and defined as:</p>
<p><span class="math display">\[
{x_t} = \int\limits_{ - \infty }^{{y_t}} {\hat f\left( u \right)du =
\hat F\left( {{y_t}} \right)}
\]</span></p>
<p>which transforms the data <span class="math inline">\(y_t\)</span>,
using the estimated distribution <span class="math inline">\(\hat
F\)</span> into i.i.d. <span class="math inline">\(U(0,1)\)</span> under
the correctly specified model.</p>
<p>Because of the difficulty in testing a <span class="math inline">\(U(0,1)\)</span> sequence, the PIT data (<span class="math inline">\(x_t\)</span>) is transformed into <span class="math inline">\(N(0,1)\)</span> by <span class="citation">Berkowitz (2001)</span> using the normal quantile
(<span class="math inline">\(\Phi^{-1}\)</span>) function:</p>
<p><span class="math display">\[
z_t = \Phi^{-1}\left(x_t\right)
\]</span></p>
<p>Under the null of a correctly forecast density the values (<span class="math inline">\(z_t\)</span>) should be independent across
observations, with mean zero, unit variance and non-significant
autoregressive terms (zero). For example, the following first order
autoregressive dynamics can be tested:</p>
<p><span class="math display">\[
z_t = \mu + \rho\left(z_{t-1} - \mu\right) + \varepsilon_t
\]</span></p>
<p>as the unrestricted equation in a likelihood ratio (LR) test against
the restricted equation where <span class="math inline">\(\mu=0\)</span>, <span class="math inline">\(\sigma=1\)</span> and <span class="math inline">\(\rho=0\)</span>. The LR test is then:</p>
<p><span class="math display">\[
\mathrm{LR} = -2\left(L\left(0,1,0\right) -
L\left(\hat\mu,\hat\sigma,\hat\rho\right)\right)
\]</span></p>
<p>where <span class="math inline">\(L\)</span> is the log-likelihood.
The LR test statistic is asymptotically distributed as <span class="math inline">\(\chi^2(2+m)\)</span> where <span class="math inline">\(m\)</span> are the number of autoregressive
lags.</p>
<p>A final testing step can also be included which looks at the goodness
of fit of the transformed series into the Normal. Following <span class="citation">Dowd (2004)</span>, the output includes the Normality
test of <span class="citation">Jarque and Bera (1987)</span>.</p>
<p>We use the GARCH based pre-computed backtest<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> in the package for the
example:</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pdist</span>(<span class="st">&#39;jsu&#39;</span>, <span class="at">q =</span> garch_forecast<span class="sc">$</span>actual, <span class="at">mu =</span> garch_forecast<span class="sc">$</span>forecast,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="at">sigma =</span> garch_forecast<span class="sc">$</span>sigma, <span class="at">skew =</span> garch_forecast<span class="sc">$</span>skew,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="at">shape =</span> garch_forecast<span class="sc">$</span>shape)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">as_flextable</span>(<span class="fu">berkowitz_test</span>(p))</span></code></pre></div>
</details>
<div class="tabwid"><style>.cl-9483250a{}.cl-9480a71c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9480a726{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-94818358{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94818362{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94818363{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:0;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94818dbc{width:1.226in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dbd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dc6{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dc7{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dd0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dd1{width:1.226in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dd2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dda{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818ddb{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818ddc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818de4{width:1.226in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818de5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dee{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818def{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818df0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818df1{width:1.226in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818df8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818df9{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dfa{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dfb{width:1.226in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818dfc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818e02{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94818e03{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-9483250a"><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>Berkowitz Density Forecast Test</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-94818dbc"><p class="cl-94818358"><span class="cl-9480a71c">Test</span></p></th><th class="cl-94818dbd"><p class="cl-94818362"><span class="cl-9480a71c">DoF</span></p></th><th class="cl-94818dc6"><p class="cl-94818362"><span class="cl-9480a71c">Statistic</span></p></th><th class="cl-94818dc7"><p class="cl-94818362"><span class="cl-9480a71c">Pr(&gt;Chisq)</span></p></th><th class="cl-94818dd0"><p class="cl-94818363"><span class="cl-9480a71c"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-94818dd1"><p class="cl-94818358"><span class="cl-9480a71c">Berkowitz</span></p></td><td class="cl-94818dd2"><p class="cl-94818362"><span class="cl-9480a71c">3</span></p></td><td class="cl-94818dda"><p class="cl-94818362"><span class="cl-9480a71c">3.2655</span></p></td><td class="cl-94818ddb"><p class="cl-94818362"><span class="cl-9480a71c">0.3525</span></p></td><td class="cl-94818ddc"><p class="cl-94818363"><span class="cl-9480a726"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-94818de4"><p class="cl-94818358"><span class="cl-9480a71c">Jarque-Bera</span></p></td><td class="cl-94818de5"><p class="cl-94818362"><span class="cl-9480a71c">2</span></p></td><td class="cl-94818dee"><p class="cl-94818362"><span class="cl-9480a71c">3.5131</span></p></td><td class="cl-94818def"><p class="cl-94818362"><span class="cl-9480a71c">0.1726</span></p></td><td class="cl-94818df0"><p class="cl-94818363"><span class="cl-9480a726"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-94818df1"><p class="cl-94818358"><span class="cl-9480a71c">Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-94818dfb"><p class="cl-94818358"><span class="cl-9480a71c">Hypothesis(H0) : Normal(0,1) with no autocorrelation</span></p></td></tr></tfoot></table></div>
<p>Both the p-values of the LR and Jarque-Bera tests are greater than 5%
so at this level we fail to reject the null hypothesis, and find the
density forecast adequately meets the requirements of these tests.</p>
</div>
<div id="directional-accuracy" class="section level2">
<h2>Directional Accuracy</h2>
<p>High and significant Directional Accuracy could imply either an
ability to predict the sign of the mean forecast or could merely be the
result of volatility dependence in the absence of mean predictability as
argued by <span class="citation">P. F. Christoffersen and Diebold
(2006)</span>.</p>
<p><span class="citation">Pesaran and Timmermann (1992)</span> provide a
non-parametric test to evaluate the magnitude and significance of the
forecast’s directional accuracy. Let <span class="math inline">\(y_t\)</span> denote the actual series and <span class="math inline">\(x_t\)</span> the forecast of that series, then the
null hypothesis is that the two are independent (the forecast cannot
predict the actual). This is a Hausman type test with statistic:</p>
<p><span class="math display">\[
S_n = \frac{ P - P_*}{\sqrt{\left[V\left(P\right) -
V\left(P_*\right)\right]}}
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
P = \frac{1}{n} \sum^n_{t=1}H\left(y_t x_t\right)
\]</span></p>
<p>representing the proportion of times that x correctly predicts y,
with <span class="math inline">\(H(.)\)</span> being the Heaviside
function taking values of 1 if the signs of the forecast and actual
agree and 0 otherwise.</p>
<p>Further,</p>
<p><span class="math display">\[
P_* = P_y P_x + \left(1 - P_y\right)\left(1 - P_x\right)
\]</span></p>
<p>with <span class="math inline">\(P_y\)</span> and <span class="math inline">\(P_x\)</span> the proportion of positive cases in y
and x respectively. The equation represents the expected proportion of
times that x would correctly predict y, under the assumption that they
are independently distributed (the null). This difference between
realized proportion and expected proportion under the null forms the
basis of the Hausman test statistic. The denominator standardizes this
difference in proportions by the difference in the variance of the two
proportions, with:</p>
<p><span class="math display">\[
V\left(P\right) = \frac{1}{n}P_*\left(1 - P_*\right)
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\begin{aligned}
V\left(P_*\right) =&amp; \frac{1}{n}\left(2 P_y-1\right)^2 P_x\left(1-
P_x\right) + \\
&amp; \frac{1}{n}\left(2 P_x-1\right)^2 P_y\left(1- P_y\right)+\\
&amp; \frac{4}{n^2} P_y P_x\left(1 - P_y\right)\left(1 - P_x\right)
\end{aligned}
\]</span></p>
<p>The statistic <span class="math inline">\(S_n\)</span> is
asymptotically distributed as <span class="math inline">\(N\left(0,1\right)\)</span>.</p>
<p>While <span class="citation">Pesaran and Timmermann (1992)</span>
test for sign predictability, <span class="citation">Anatolyev and Gerko
(2005)</span> test for mean predictability based on normalized excess
profitability implied by a directional strategy which goes long or short
depending on the sign of the forecast. One of the key differences
between these two tests relates to the observed asymmetric nature of
<span class="math inline">\(y_t\)</span>, which means that it may matter
when <span class="math inline">\(x_t\)</span> fails to predict <span class="math inline">\(y_t\)</span> if during those times the loss (or
missed gain) is high enough to make the strategy relatively unprofitable
despite having significant directional accuracy. Consider the 1-period
return of the trading strategy:</p>
<p><span class="math display">\[
r_t = \textrm{sign}\left(x_t\right)y_t
\]</span></p>
<p>with expected return</p>
<p><span class="math display">\[
A_n = \frac{1}{n}\sum^n_{t=1}r_t
\]</span></p>
<p>A benchmark strategy which issues buy and sell signals at random with
proportions of buys and sells the same as in the trading strategy, has
the following expected return:</p>
<p><span class="math display">\[
B_n =
\left(\frac{1}{n}\sum^n_{t=1}\textrm{sign}\left(x_t\right)\right)\left(\frac{1}{n}\sum^n_{t=1}y_t\right)
\]</span></p>
<p>Under the null of conditional mean independence, then <span class="math inline">\(E\left[y_t|I_{t-1}\right] =
\mathrm{constant}\)</span>. If the strategy has predictive power, it
will generate higher returns on average than the benchmark, and <span class="math inline">\(A_n - B_n\)</span> will be greater than zero and
significant. To test the significance of this difference, it needs to be
normalized by the the variance of this difference (<span class="math inline">\(V\)</span>):</p>
<p><span class="math display">\[
V = \frac{4}{n^2} p_y\left(1 - p_y\right)\sum^n_{t=1}\left(y_t-
y\right)^2
\]</span></p>
<p>where <span class="math inline">\(p_y=\frac{1}{2}\left(1 +
\frac{1}{n}\sum^n_{t=1}\mathrm{sign}\left(y_t\right)\right)\)</span>.</p>
<p>Similar to the test of <span class="citation">Pesaran and Timmermann
(1992)</span>, this is also a Hausman test with statistic <span class="math inline">\(\frac{A_n - B_n}{\sqrt(V)}\)</span>,
asymptotically distribution as <span class="math inline">\(N\left(0,1\right)\)</span>.</p>
<p>To illustrate we use an ARMA(1,1) pre-computed backtest forecast
available in the package:</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">as_flextable</span>(<span class="fu">dac_test</span>(arma_forecast<span class="sc">$</span>actual, arma_forecast<span class="sc">$</span>forecast))</span></code></pre></div>
</details>
<div class="tabwid"><style>.cl-94928ca2{}.cl-9490694a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-94906954{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-949141da{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-949141e4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-949141e5{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:0;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94914bbc{width:1.175in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bbd{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bc6{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bc7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bc8{width:1.175in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bc9{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bca{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bd0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bd1{width:1.175in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bd2{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bda{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bdb{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bdc{width:1.175in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bdd{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914be4{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914be5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914be6{width:1.175in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914be7{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914be8{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bee{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bef{width:1.175in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bf0{width:0.92in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bf1{width:0.852in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94914bf8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-94928ca2"><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>Directional Accuracy Tests</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-94914bbc"><p class="cl-949141da"><span class="cl-9490694a">Test</span></p></th><th class="cl-94914bbd"><p class="cl-949141e4"><span class="cl-9490694a">Statistic</span></p></th><th class="cl-94914bc6"><p class="cl-949141e4"><span class="cl-9490694a">Pr(&gt;|t|)</span></p></th><th class="cl-94914bc7"><p class="cl-949141e5"><span class="cl-9490694a"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-94914bc8"><p class="cl-949141da"><span class="cl-9490694a">PT: (Sign)</span></p></td><td class="cl-94914bc9"><p class="cl-949141e4"><span class="cl-9490694a">0.3594</span></p></td><td class="cl-94914bca"><p class="cl-949141e4"><span class="cl-9490694a">0.3596</span></p></td><td class="cl-94914bd0"><p class="cl-949141e5"><span class="cl-94906954"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-94914bd1"><p class="cl-949141da"><span class="cl-9490694a">AG: (Mean)</span></p></td><td class="cl-94914bd2"><p class="cl-949141e4"><span class="cl-9490694a">0.1144</span></p></td><td class="cl-94914bda"><p class="cl-949141e4"><span class="cl-9490694a">0.4545</span></p></td><td class="cl-94914bdb"><p class="cl-949141e5"><span class="cl-94906954"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-94914bdc"><p class="cl-949141da"><span class="cl-9490694a">Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-94914be6"><p class="cl-949141da"><span class="cl-9490694a">Obs: 250, Accuracy: 0.5, Prevalence: 0.464</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-94914bef"><p class="cl-949141da"><span class="cl-9490694a">Hypothesis(H0) : PT: No Predictability (Sign)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-94914bef"><p class="cl-949141da"><span class="cl-9490694a">Hypothesis(H0) : AG: No Predictability (Mean)</span></p></td></tr></tfoot></table></div>
<p>The p-values for both tests in the table above suggest that we fail
to reject the null of no predictability, with high confidence.</p>
</div>
<div id="forecast-unbiasedness" class="section level2">
<h2>Forecast Unbiasedness</h2>
<p>To understand the properties of a good forecast, we start by
considering what an optimal forecast should look like. Consider the Wald
representation of <span class="math inline">\(y\)</span>, at horizon
h:</p>
<p><span class="math display">\[
y_{n+h} = \mu + \epsilon_{n+h} + b_1\epsilon_{n+h-1} +
b_2\epsilon_{n+h-2} + \ldots
\]</span></p>
<p>The optimal h-step forecast is then</p>
<p><span class="math display">\[
y_{n+h|n} = \mu + b_h\epsilon_n + b_{h+1}\epsilon_{n-1} + \ldots
\]</span></p>
<p>with optimal forecast error</p>
<p><span class="math display">\[
\epsilon_{n+h|n} = \epsilon_{n+h} + b_1\epsilon_{n+h-1} +
b_2\epsilon_{n+h-2} + \ldots + b_{h-1}\epsilon_{n+1}
\]</span></p>
<p>and variance of the h-step forecast error increasing in h.</p>
<p>The optimal forecast error is unbiased with <span class="math inline">\(E\left[\epsilon_{n+h|n}\right] = 0\)</span>, with
the h-step forecast errors having at most an MA(h-1) structure and the
1-step ahead forecast error <span class="math inline">\(\epsilon_{n+1|n}
= \epsilon_{n+h}\)</span> being white noise. This implies that :</p>
<p><span class="math display">\[
\epsilon_{n+h|n} = \alpha + \beta y_{n+h|n} + \varepsilon_{n+h}
\]</span></p>
<p>will have <span class="math inline">\(\alpha=0\)</span> and <span class="math inline">\(\beta=0\)</span>.</p>
<p>Since</p>
<p><span class="math display">\[
\epsilon_{n+h|n} = y_{n+h} - y_{n+h|n}
\]</span></p>
<p>then,</p>
<p><span class="math display">\[
y_{n+h|n} = \alpha + \beta x_{n+h|n} + \varepsilon_{n+h|n}
\]</span></p>
<p>can be tested under the null of unbiasedness with <span class="math inline">\(\alpha=0\)</span> and <span class="math inline">\(\beta=1\)</span> using a Wald test. This is the
essence of the regression test by <span class="citation">Mincer and
Zarnowitz (1969)</span>. It effectively tests for forecast bias, though
it does not say anything about forecast variance.</p>
<p>The table below shows the output of the test using a 15-step ahead
forecast on a chosen subsample of SPY log returns from an ARMA(15,0)
model. We fail to reject the NULL of <span class="math inline">\(\alpha=0\)</span> and <span class="math inline">\(\beta=1\)</span> given the results of the Wald
test with Pr(&gt;Chisq) = 0.96.</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>spyr <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">diff</span>(<span class="fu">log</span>(spy)))</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="fu">as.numeric</span>(spyr[<span class="dv">2000</span><span class="sc">:</span><span class="dv">2500</span>]), <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">transform.pars =</span> <span class="cn">TRUE</span>, <span class="at">include.mean =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">n.ahead =</span> <span class="dv">15</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">minzar_test</span>(<span class="at">actual =</span> <span class="fu">as.numeric</span>(spyr[<span class="dv">2501</span><span class="sc">:</span><span class="dv">2515</span>]), </span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                    <span class="at">forecast =</span> <span class="fu">as.numeric</span>(p<span class="sc">$</span>pred))</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="fu">as_flextable</span>(test, <span class="at">footnote.reference =</span> T, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="tabwid"><style>.cl-94cce8e8{}.cl-94cab78a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-94cab78b{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-94cb92d6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94cb92d7{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94cb92e0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:0;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94cb9c54{width:0.963in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c5e{width:0.98in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c5f{width:1.039in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c60{width:0.835in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c61{width:0.851in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c62{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c68{width:0.963in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c69{width:0.98in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c6a{width:1.039in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c72{width:0.835in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c73{width:0.851in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c7c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c7d{width:0.963in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c7e{width:0.98in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c7f{width:1.039in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c86{width:0.835in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c87{width:0.851in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c88{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c90{width:0.963in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c91{width:0.98in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c92{width:1.039in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c93{width:0.835in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c94{width:0.851in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c9a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c9b{width:0.963in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9c9c{width:0.98in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9ca4{width:1.039in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9ca5{width:0.835in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9ca6{width:0.851in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9ca7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9cae{width:0.963in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9caf{width:0.98in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9cb0{width:1.039in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9cb1{width:0.835in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9cb8{width:0.851in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9cb9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9cba{width:0.963in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9cc2{width:0.98in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9cc3{width:1.039in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9cc4{width:0.835in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9cc5{width:0.851in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94cb9ccc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-94cce8e8"><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>Mincer-Zarnowitz Test</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-94cb9c54"><p class="cl-94cb92d6"><span class="cl-94cab78a"></span></p></th><th class="cl-94cb9c5e"><p class="cl-94cb92d7"><span class="cl-94cab78a">Estimate</span></p></th><th class="cl-94cb9c5f"><p class="cl-94cb92d7"><span class="cl-94cab78a">Std. Error</span></p></th><th class="cl-94cb9c60"><p class="cl-94cb92d7"><span class="cl-94cab78a">t value</span></p></th><th class="cl-94cb9c61"><p class="cl-94cb92d7"><span class="cl-94cab78a">Pr(&gt;|t|)</span></p></th><th class="cl-94cb9c62"><p class="cl-94cb92e0"><span class="cl-94cab78a"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-94cb9c68"><p class="cl-94cb92d6"><span class="cl-94cab78a">constant</span></p></td><td class="cl-94cb9c69"><p class="cl-94cb92d7"><span class="cl-94cab78a">0.00</span></p></td><td class="cl-94cb9c6a"><p class="cl-94cb92d7"><span class="cl-94cab78a">0.00</span></p></td><td class="cl-94cb9c72"><p class="cl-94cb92d7"><span class="cl-94cab78a">0.28</span></p></td><td class="cl-94cb9c73"><p class="cl-94cb92d7"><span class="cl-94cab78a">0.79</span></p></td><td class="cl-94cb9c7c"><p class="cl-94cb92e0"><span class="cl-94cab78b"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-94cb9c7d"><p class="cl-94cb92d6"><span class="cl-94cab78a">forecast</span></p></td><td class="cl-94cb9c7e"><p class="cl-94cb92d7"><span class="cl-94cab78a">1.04</span></p></td><td class="cl-94cb9c7f"><p class="cl-94cb92d7"><span class="cl-94cab78a">2.46</span></p></td><td class="cl-94cb9c86"><p class="cl-94cb92d7"><span class="cl-94cab78a">0.42</span></p></td><td class="cl-94cb9c87"><p class="cl-94cb92d7"><span class="cl-94cab78a">0.68</span></p></td><td class="cl-94cb9c88"><p class="cl-94cb92e0"><span class="cl-94cab78b"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-94cb9c90"><p class="cl-94cb92d6"><span class="cl-94cab78a">J</span></p></td><td class="cl-94cb9c91"><p class="cl-94cb92d7"><span class="cl-94cab78a"></span></p></td><td class="cl-94cb9c92"><p class="cl-94cb92d7"><span class="cl-94cab78a"></span></p></td><td class="cl-94cb9c93"><p class="cl-94cb92d7"><span class="cl-94cab78a">0.09</span></p></td><td class="cl-94cb9c94"><p class="cl-94cb92d7"><span class="cl-94cab78a">0.96</span></p></td><td class="cl-94cb9c9a"><p class="cl-94cb92e0"><span class="cl-94cab78b"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-94cb9c9b"><p class="cl-94cb92d6"><span class="cl-94cab78a">Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-94cb9cae"><p class="cl-94cb92d6"><span class="cl-94cab78a">Hypothesis(H0) : Unbiased Forecast</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-94cb9cba"><p class="cl-94cb92d6"><span class="cl-94cab78a">Reference: Mincer JA. and Zarnowitz V. (1969), &#39;The evaluation of economic forecasts.&#39; In Economic forecasts and expectations: Analysis of forecasting behavior and performance, NBER, 3--46</span></p></td></tr></tfoot></table></div>
</div>
<div id="expected-shortfall" class="section level2">
<h2>Expected Shortfall</h2>
<p>The test of <span class="citation">Du and Escanciano (2017)</span>
combines ideas from <span class="citation">Berkowitz (2001)</span> and
<span class="citation">P. F. Christoffersen (1998)</span> to create an
unconditional and conditional shortfall test based on the probability
integral transformed realizations, conditioned on the forecast
distribution, to evaluate the severity and independence of the shortfall
residuals.</p>
</div>
<div id="the-unconditional-test" class="section level2">
<h2>The Unconditional Test</h2>
<p>The unconditional test assesses the expected value of the cumulative
violations beyond the Value at Risk (VaR) threshold, using a two-sided
t-test, with the following statistic:</p>
<p><span class="math display">\[
U_{ES} = \frac{\sqrt{n}\left(\bar H\left(\alpha\right) -
\frac{\alpha}{2}\right)}{\sqrt{\alpha\left(\frac{1}{3} -
\frac{\alpha}{4}\right)}}
\]</span></p>
<p>where the term <span class="math inline">\(\frac{\alpha}{2}\)</span>
is the expected value under a correctly calibrated risk model. <span class="math inline">\(\bar H\left(\alpha\right)\)</span> denotes the
sample mean of <span class="math inline">\(H_t\left(\alpha\right)\)</span>:</p>
<p><span class="math display">\[
\bar H\left(\alpha\right)=\frac{1}{n}\sum^n_{t=1}H_t\left(\alpha\right)
\]</span></p>
<p>with <span class="math inline">\(H_t\left(\alpha\right)\)</span> the
cumulative failures (violations beyond VaR) such that:</p>
<p><span class="math display">\[
H_t\left(\alpha\right) = \frac{1}{\alpha}\left(\alpha -
u_t\right)\mathrm{I}\left(u_t\le\alpha\right).
\]</span></p>
<p>The vector <span class="math inline">\(u\)</span> is the probability
integral transformation of the future realization given the forecast
distribution.</p>
<p>The distribution of the test statistic <span class="math inline">\(U_{ES}\)</span> is asymptotically distributed as
<span class="math inline">\(N(0,1)\)</span>. Since the statistic is
bounded in the unit interval, the confidence intervals need to be
constrained to the be between [0,1]. Therefore, the p-value will take
the following form:</p>
<p><span class="math display">\[
Pr(&gt;|t|) = 2 \min{\left(\mathrm{Pr}\left[|U_{ES}|\le
x\right],1-\mathrm{Pr}\left[|U_{ES}|\le x\right]\right)}
\]</span></p>
</div>
<div id="the-conditional-test" class="section level2">
<h2>The Conditional Test</h2>
<p>The conditional test assesses not only the correctness and
significance of the expected value of the cumulative failures but also
their independence. Consider the auto-covariance of the cumulative
violations for lag j:</p>
<p><span class="math display">\[
\gamma_j = \frac{1}{n-j}\sum^n_{t=j+1} \left(H_t -
\frac{\alpha}{2}\right)\left(H_{t-j}-\frac{\alpha}{2}\right).
\]</span></p>
<p>The autocorrelation is then equal to:</p>
<p><span class="math display">\[
\rho_j = \frac{\gamma_j}{\gamma_0}
\]</span> and the test statistic for m lags is:</p>
<p><span class="math display">\[
C_{ES} = n\sum^m_{j=1}\rho^2_j
\]</span></p>
<p>which is asymptotically distributed as <span class="math inline">\(\chi^2_m\)</span>, and is independent of <span class="math inline">\(\alpha\)</span>.</p>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>The following example, using the pre-computed GARCH backtest data,
highlights the approach to using the <code>shortfall_de_test</code>
function.</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># the pit data</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">pdist</span>(<span class="st">&quot;jsu&quot;</span>, <span class="at">q =</span> garch_forecast<span class="sc">$</span>actual, <span class="at">mu =</span> garch_forecast<span class="sc">$</span>forecast,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="at">sigma =</span> garch_forecast<span class="sc">$</span>sigma, <span class="at">skew =</span> garch_forecast<span class="sc">$</span>skew,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="at">shape =</span> garch_forecast<span class="sc">$</span>shape)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">shortfall_de_test</span>(x, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">lags =</span> <span class="dv">4</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="fu">as_flextable</span>(test, <span class="at">footnote.reference =</span> T) <span class="sc">|&gt;</span> <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">width =</span> <span class="fl">1.2</span>)</span></code></pre></div>
</details>
<div class="tabwid"><style>.cl-94dc78ee{}.cl-94da53e8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-94da53e9{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-94db3100{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94db310a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94db310b{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:0;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94db3ae2{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3ae3{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3ae4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3aec{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3aed{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3aee{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3aef{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3af6{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3af7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3af8{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3af9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3b00{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3b01{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3b02{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94db3b03{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-94dc78ee"><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>Expected Shortfall Test (Du and Escanciano)</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-94db3ae2"><p class="cl-94db3100"><span class="cl-94da53e8">Test</span></p></th><th class="cl-94db3ae3"><p class="cl-94db310a"><span class="cl-94da53e8">Statistic</span></p></th><th class="cl-94db3ae3"><p class="cl-94db310a"><span class="cl-94da53e8">Pr(&gt;|t|)</span></p></th><th class="cl-94db3ae4"><p class="cl-94db310b"><span class="cl-94da53e8"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-94db3aec"><p class="cl-94db3100"><span class="cl-94da53e8">DE (U)</span></p></td><td class="cl-94db3aed"><p class="cl-94db310a"><span class="cl-94da53e8">0.0277</span></p></td><td class="cl-94db3aed"><p class="cl-94db310a"><span class="cl-94da53e8">0.7377</span></p></td><td class="cl-94db3aee"><p class="cl-94db310b"><span class="cl-94da53e9"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-94db3aef"><p class="cl-94db3100"><span class="cl-94da53e8">DE (C)</span></p></td><td class="cl-94db3af6"><p class="cl-94db310a"><span class="cl-94da53e8">2.7680</span></p></td><td class="cl-94db3af6"><p class="cl-94db310a"><span class="cl-94da53e8">0.5974</span></p></td><td class="cl-94db3af7"><p class="cl-94db310b"><span class="cl-94da53e9"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-94db3af8"><p class="cl-94db3100"><span class="cl-94da53e8">Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-94db3b00"><p class="cl-94db3100"><span class="cl-94da53e8">Coverage: 0.05, Obs: 250</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-94db3b02"><p class="cl-94db3100"><span class="cl-94da53e8">Hypothesis(H0) : Unconditional(U) and Independent(C)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-94db3b02"><p class="cl-94db3100"><span class="cl-94da53e8">Reference: Du Z. and Escanciano J.C. (2017). Backtesting expected shortfall: accounting for tail risk. Management Science, 63(4), 940--958.</span></p></td></tr></tfoot></table></div>
</div>
<div id="value-at-risk-coverage-and-duration" class="section level2">
<h2>Value at Risk: Coverage and Duration</h2>
<p>The Value at Risk (VaR) tests in the <code>tstests</code> package are
based on the proportion of failures test of <span class="citation">Kupiec (1995)</span>, the conditional coverage test of
<span class="citation">P. F. Christoffersen (1998)</span>, and the
duration between failures test of <span class="citation">P. F.
Christoffersen and Pelletier (2004)</span>. These are summarized in the
next sections.</p>
</div>
<div id="proportion-of-failures-uc" class="section level2">
<h2>Proportion of Failures (<code>UC</code>)</h2>
<p>The test of <span class="citation">Kupiec (1995)</span> assesses
whether the proportion of failures is consistent with the expected
proportion of failures at a given level of VaR. This is done by summing
the number of violation (binary) and dividing by the length of the
forecasts.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> Under the null hypothesis that the
proportion of failures (<span class="math inline">\(\pi\)</span>) is
equal to the VaR level (<span class="math inline">\(\alpha\)</span>),
then the restricted model likelihood is:</p>
<p><span class="math display">\[
\mathrm{L}_r = \left(1 - \alpha\right)^{n}\alpha^{k}
\]</span> and the unrestricted (observed) model likelihood:</p>
<p><span class="math display">\[
\mathrm{L}_u = \left(1 - \pi\right)^{n}\pi^{k}
\]</span> where <span class="math inline">\(\pi=\frac{n}{\left(n +
k\right)}\)</span>, <span class="math inline">\(n\)</span> are the
number of observations, and <span class="math inline">\(k\)</span> the
number of failures. A likelihood ratio test can then be conducted with
statistic:</p>
<p><span class="math display">\[
\mathrm{LR}_{uc} = -2\log{\frac{\mathrm{L}_r}{\mathrm{L}_u}}
\]</span></p>
<p>which is distributed as <span class="math inline">\(\chi^2_1\)</span>.</p>
</div>
<div id="independence-of-failures-cci" class="section level2">
<h2>Independence of Failures (<code>CCI</code>)</h2>
<p>The proportion of failures (or unconditional) test of <span class="citation">Kupiec (1995)</span> tests the coverage of the interval
but has no power in detecting whether they are independent. <span class="citation">P. F. Christoffersen (1998)</span> proposed a test to
explicitly check the independence assumption against a first order
Markov alternative. Consider a binary, first order Markov chain with
transition probability matrix:</p>
<p><span class="math display">\[
\Pi_1 =
\begin{bmatrix}
1-\pi_{01} &amp; \pi_{01}\\
1-\pi_{11} &amp; p_{11}
\end{bmatrix}
\]</span></p>
<p>where <span class="math inline">\(\pi_{ij}=Pr\left(I_t=j|I_{t-1}-i\right)\)</span>,
and <span class="math inline">\(I_t\)</span> is the indicator function
denoting failures. The approximate likelihood of this process is
then</p>
<p><span class="math display">\[
\mathrm{L}_u =
\left(1-\pi_{01}\right)^{n_{00}}\pi_{01}^{n_{01}}\left(1-\pi_{11}\right)^{n_{10}}\pi_{11}^{n_{11}}
\]</span> where <span class="math inline">\(n_{ij}\)</span> is the
number of observation with value i followed by j. For example, <span class="math inline">\(n_{10}\)</span> represents the number of periods
with failures followed by periods with no failures. For the restricted
model under the null of independence, the first order Markov chain has
the following transition probability matrix:</p>
<p><span class="math display">\[
\Pi_1 =
\begin{bmatrix}
1-\pi_2 &amp; \pi_2\\
1-\pi_2 &amp; \pi_2\\
\end{bmatrix}
\]</span> with the following likelihood:</p>
<p><span class="math display">\[
\mathrm{L}_r = \left(1 - \pi_2\right)^{n_{00} + n_{10}}\pi_2^{n_{01} +
n_{11}}
\]</span></p>
<p>Finally, the likelihood ratio for the test of independence can be
expressed as:</p>
<p><span class="math display">\[
\mathrm{LR}_{cci} = -2\log\frac{L_r}{L_u}
\]</span></p>
<p>which is asymptotically distributed as <span class="math inline">\(\chi^2\left(1\right)\)</span>.</p>
</div>
<div id="conditional-coverage-cc" class="section level2">
<h2>Conditional Coverage (<code>CC</code>)</h2>
<p>The likelihood ratio for the joint test of coverage and independence
is simply the sum of the Kupiec coverage and independence likelihood
ratios:</p>
<p><span class="math display">\[
\mathrm{LR}_{cc} = \mathrm{LR}_{uc} + \mathrm{LR}_{cci}
\]</span> which is asymptotically distributed as <span class="math inline">\(\chi^2\left(2\right)\)</span>.</p>
</div>
<div id="duration-between-failures-d" class="section level2">
<h2>Duration between Failures (<code>D</code>)</h2>
<p>The conditional coverage independence test in the previous section
has limited power in detecting temporal dependence beyond the simple
first order Markov structure. To provide a more powerful test <span class="citation">P. F. Christoffersen and Pelletier (2004)</span>
proposed a more general structure using the duration of time between VaR
failures (the no-hit duration), defined as :</p>
<p><span class="math display">\[
D_i = t_i - t_{i-1}
\]</span></p>
<p>where <span class="math inline">\(t_i\)</span> denotes the time index
of violation number <span class="math inline">\(i\)</span>. Under the
null hypothesis of a correctly specified risk model, this no-hit
duration (<span class="math inline">\(D\)</span>) should have no memory
with a mean duration of <span class="math inline">\(\frac{1}{\alpha}\)</span> periods. Since the only
continuous memory free random distribution is the exponential, then
under the null hypothesis the distribution of the no-hit duration should
be:</p>
<p><span class="math display">\[
f_{\mathrm{exp}}\left(D;\alpha\right) = p\exp\left(-\alpha D\right).
\]</span></p>
<p>In order to test for this, an encompassing distribution which allows
for duration dependence and also embeds the exponential is required. The
Weibull distribution offers one such example, with distribution:</p>
<p><span class="math display">\[
f_{\mathrm{W}}\left(D;a,b\right) =
a^bbD^{b-1}\exp\left(-\left(aD\right)^b\right).
\]</span></p>
<p>The exponential is a special case when <span class="math inline">\(b=1\)</span>. Therefore, the null hypothesis of a
memory-less duration process corresponds to <span class="math inline">\(b=1\)</span> and <span class="math inline">\(a=\alpha\)</span>, which can be tested using a
likelihood ratio test distributed as <span class="math inline">\(\chi^2\left(1\right)\)</span>.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
</div>
<div id="example-1" class="section level2">
<h2>Example</h2>
<p>The table below shows the 4 tests for VaR, with p-values well above
10% indicating a correctly specified model for this series during the
out of sample period tested.</p>
<details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">qdist</span>(<span class="st">&quot;jsu&quot;</span>, <span class="at">p =</span> <span class="fl">0.05</span>, <span class="at">mu =</span> garch_forecast<span class="sc">$</span>forecast, <span class="at">sigma =</span> garch_forecast<span class="sc">$</span>sigma,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="at">skew =</span> garch_forecast<span class="sc">$</span>skew, <span class="at">shape =</span> garch_forecast<span class="sc">$</span>shape)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">var_cp_test</span>(<span class="at">actual =</span> garch_forecast<span class="sc">$</span>actual, <span class="at">forecast =</span> q, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">as_flextable</span>(test, <span class="at">footnote.reference =</span> T) <span class="sc">|&gt;</span> <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">width =</span> <span class="fl">1.2</span>)</span></code></pre></div>
</details>
<div class="tabwid"><style>.cl-94f144d6{}.cl-94eee8d0{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-94eee8d1{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-94efd56a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94efd56b{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94efd56c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:0;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94efe0b4{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0b5{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0be{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0bf{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0c0{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0c1{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0c8{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0c9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0ca{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0cb{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0d2{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0d3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0d4{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0d5{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0d6{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0dc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0dd{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0de{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0e6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0e7{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0e8{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0f0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0f1{width:1.2in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0fa{width:1.12in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94efe0fb{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-94f144d6"><caption style="display:table-caption;margin:0pt;text-align:center;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;"><span>Value at Risk Tests (Christoffersen and Pelletier)</span></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-94efe0b4"><p class="cl-94efd56a"><span class="cl-94eee8d0">Test</span></p></th><th class="cl-94efe0b5"><p class="cl-94efd56b"><span class="cl-94eee8d0">DoF</span></p></th><th class="cl-94efe0b5"><p class="cl-94efd56b"><span class="cl-94eee8d0">Statistic</span></p></th><th class="cl-94efe0be"><p class="cl-94efd56b"><span class="cl-94eee8d0">Pr(&gt;Chisq)</span></p></th><th class="cl-94efe0bf"><p class="cl-94efd56c"><span class="cl-94eee8d0"></span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-94efe0c0"><p class="cl-94efd56a"><span class="cl-94eee8d0">Kupiec (UC)</span></p></td><td class="cl-94efe0c1"><p class="cl-94efd56b"><span class="cl-94eee8d0">1</span></p></td><td class="cl-94efe0c1"><p class="cl-94efd56b"><span class="cl-94eee8d0">0.9514</span></p></td><td class="cl-94efe0c8"><p class="cl-94efd56b"><span class="cl-94eee8d0">0.3294</span></p></td><td class="cl-94efe0c9"><p class="cl-94efd56c"><span class="cl-94eee8d1"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-94efe0ca"><p class="cl-94efd56a"><span class="cl-94eee8d0">CP (CCI)</span></p></td><td class="cl-94efe0cb"><p class="cl-94efd56b"><span class="cl-94eee8d0">1</span></p></td><td class="cl-94efe0cb"><p class="cl-94efd56b"><span class="cl-94eee8d0">0.0009</span></p></td><td class="cl-94efe0d2"><p class="cl-94efd56b"><span class="cl-94eee8d0">0.9763</span></p></td><td class="cl-94efe0d3"><p class="cl-94efd56c"><span class="cl-94eee8d1"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-94efe0ca"><p class="cl-94efd56a"><span class="cl-94eee8d0">CP (CC)</span></p></td><td class="cl-94efe0cb"><p class="cl-94efd56b"><span class="cl-94eee8d0">2</span></p></td><td class="cl-94efe0cb"><p class="cl-94efd56b"><span class="cl-94eee8d0">0.9522</span></p></td><td class="cl-94efe0d2"><p class="cl-94efd56b"><span class="cl-94eee8d0">0.6212</span></p></td><td class="cl-94efe0d3"><p class="cl-94efd56c"><span class="cl-94eee8d1"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-94efe0d4"><p class="cl-94efd56a"><span class="cl-94eee8d0">CP (D)</span></p></td><td class="cl-94efe0d5"><p class="cl-94efd56b"><span class="cl-94eee8d0">1</span></p></td><td class="cl-94efe0d5"><p class="cl-94efd56b"><span class="cl-94eee8d0">0.0821</span></p></td><td class="cl-94efe0d6"><p class="cl-94efd56b"><span class="cl-94eee8d0">0.7745</span></p></td><td class="cl-94efe0dc"><p class="cl-94efd56c"><span class="cl-94eee8d1"></span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-94efe0dd"><p class="cl-94efd56a"><span class="cl-94eee8d0">Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-94efe0e7"><p class="cl-94efd56a"><span class="cl-94eee8d0">Coverage: 0.05, Obs: 250, Failures: 16, E[Failures]: 12</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-94efe0f1"><p class="cl-94efd56a"><span class="cl-94eee8d0">Hypothesis(H0) : Unconditional(UC), Independent(CCI), Joint Coverage(CC) and Duration(D)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-94efe0f1"><p class="cl-94efd56a"><span class="cl-94eee8d0">References: </span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-94efe0f1"><p class="cl-94efd56a"><span class="cl-94eee8d0">Kupic, P. (1995), Techniques for verifying accuracy of risk measurement models, Journal of Derivatives, 3, 73--84.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-94efe0f1"><p class="cl-94efd56a"><span class="cl-94eee8d0">Christoffersen, P. (1998), Evaluating Interval Forecasts, International Economic Review, 39, 841--862.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-94efe0f1"><p class="cl-94efd56a"><span class="cl-94eee8d0">Christoffersen, P. and Pelletier, D. (2004), Backtesting value-at-risk: A duration-based approach, Journal of Financial Econometrics, 2(1), 84--108.</span></p></td></tr></tfoot></table></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Ait1996" class="csl-entry">
Ait-Sahalia, Y. 1996. <span>“Testing Continuous-Time Models of the Spot
Interest Rate.”</span> <em>The Review of Financial Studies</em> 9 (2):
385–426.
</div>
<div id="ref-Anatolyev2005" class="csl-entry">
Anatolyev, S., and A. Gerko. 2005. <span>“A Trading Approach to Testing
for Predictability.”</span> <em>Journal of Business &amp; Economic
Statistics</em> 23 (4): 455–61.
</div>
<div id="ref-Berkowitz2001" class="csl-entry">
Berkowitz, J. 2001. <span>“Testing Density Forecasts, with Applications
to Risk Management.”</span> <em>Journal of Business &amp; Economic
Statistics</em> 19 (4): 465–74.
</div>
<div id="ref-Christoffersen1998" class="csl-entry">
Christoffersen, P. F. 1998. <span>“Evaluating Interval
Forecasts.”</span> <em>International Economic Review</em>, 841–62.
</div>
<div id="ref-Christoffersen2006" class="csl-entry">
Christoffersen, P.F., and F.X. Diebold. 2006. <span>“Financial Asset
Returns, Direction-of-Change Forecasting, and Volatility
Dynamics.”</span> <em>Management Science</em> 52 (8): 1273–87.
</div>
<div id="ref-Christoffersen2004" class="csl-entry">
Christoffersen, P.F., and D. Pelletier. 2004. <span>“Backtesting
Value-at-Risk: A Duration-Based Approach.”</span> <em>Journal of
Financial Econometrics</em> 2 (1): 84–108.
</div>
<div id="ref-Dowd2004" class="csl-entry">
Dowd, K. 2004. <span>“A Modified Berkowitz Back-Test.”</span> <em>Risk
Magazine</em> 17 (4): 86–87.
</div>
<div id="ref-Du2017" class="csl-entry">
Du, Z., and J. C. Escanciano. 2017. <span>“Backtesting Expected
Shortfall: Accounting for Tail Risk.”</span> <em>Management Science</em>
63 (4): 940–58.
</div>
<div id="ref-Engleng1993" class="csl-entry">
Engle, R. F., and V. K. Ng. 1993. <span>“Measuring and Testing the
Impact of News on Volatility.”</span> <em>The Journal of Finance</em> 48
(5): 1749–78.
</div>
<div id="ref-Hamilton2020" class="csl-entry">
Hamilton, J. D. 2020. <em>Time Series Analysis</em>. Princeton
university press.
</div>
<div id="ref-Hansen1992" class="csl-entry">
Hansen, B. E. 1992. <span>“Testing for Parameter Instability in Linear
Models.”</span> <em>Journal of Policy Modeling</em> 14 (4): 517–33.
</div>
<div id="ref-Hansen1982" class="csl-entry">
Hansen, L.P. 1982. <span>“Large Sample Properties of Generalized Method
of Moments Estimators.”</span> <em>Econometrica</em> 50 (4): 1029–54.
</div>
<div id="ref-Hong2005" class="csl-entry">
Hong, Y., and H. Li. 2005. <span>“Nonparametric Specification Testing
for Continuous-Time Models with Applications to Term Structure of
Interest Rates.”</span> <em>Review of Financial Studies</em> 18 (1):
37–84.
</div>
<div id="ref-Jarque1987" class="csl-entry">
Jarque, C.M., and A.K. Bera. 1987. <span>“A Test for Normality of
Observations and Regression Residuals.”</span> <em>International
Statistical Review/Revue Internationale de Statistique</em>, 163–72.
</div>
<div id="ref-Kupiec1995" class="csl-entry">
Kupiec, P.H. 1995. <span>“Techniques for Verifying the Accuracy of Risk
Measurement Models.”</span> <em>The Journal of Derivatives</em> 3 (2):
73–84.
</div>
<div id="ref-Mincer1969" class="csl-entry">
Mincer, J.A., and V. Zarnowitz. 1969. <span>“The Evaluation of Economic
Forecasts.”</span> In <em>Economic Forecasts and Expectations: Analysis
of Forecasting Behavior and Performance</em>, 3–46. NBER.
</div>
<div id="ref-Nyblom1989" class="csl-entry">
Nyblom, J. 1989. <span>“Testing for the Constancy of Parameters over
Time.”</span> <em>Journal of the American Statistical Association</em>
84 (405): 223–30.
</div>
<div id="ref-Pesaran1992" class="csl-entry">
Pesaran, M.H., and A. Timmermann. 1992. <span>“A Simple Nonparametric
Test of Predictive Performance.”</span> <em>Journal of Business &amp;
Economic Statistics</em> 10 (4): 461–65.
</div>
<div id="ref-Rosenblatt1952" class="csl-entry">
Rosenblatt, M. 1952. <span>“Remarks on a Multivariate
Transformation.”</span> <em>The Annals of Mathematical Statistics</em>
23 (3): 470–72.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>It is also possible to correct this estimator for serial
correlation as suggested by <span class="citation">Hamilton
(2020)</span>, but we leave this for future investigation.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Asymptotically distributed as <span class="math inline">\(\chi^2\)</span>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>All joint tests are denoted by the capital letter <span class="math inline">\(J\)</span> in the package.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>From equation 3.3 of <span class="citation">Nyblom
(1989)</span>.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Based on the SPY log returns data using a GARCH(1,1)-JSU
model (see documentation for details and replication code).<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Under the assumption of i.i.d observations, the sequence
of failures is distributed as Bernoulli(<span class="math inline">\(\alpha\)</span>).<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>The actual implementation requires calculating the
duration of the hit sequence, the censored observations and combining
all this to construct the log-likelihood which needs to be solved using
numerical methods for the unrestricted likelihood.<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
